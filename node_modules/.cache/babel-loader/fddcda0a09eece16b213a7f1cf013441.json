{"ast":null,"code":"var _jsxFileName = \"/Users/cryox/Documents/Github/ESGI/hackaton/brumar-api/src/components/cart/Cart.js\";\nimport React, { useEffect, useState } from 'react';\nimport './Cart.css';\nimport axios from \"axios\";\nimport { getImg } from \"../common/FileUtils\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst Cart = props => {\n  let [loading, setLoading] = useState(true);\n  let [articles, setArticles] = useState([]);\n  let [scooter, setScooter] = useState(null);\n  let [topCase, setTopCase] = useState(null);\n  const queryStream = new URLSearchParams(props.location.search);\n  useEffect(() => {\n    getScooter(queryStream.get('scooter_id')); // getTopcases(queryStream.get('top_case'))\n  }, []);\n  useEffect(() => {\n    console.log(scooter);\n  }, []);\n\n  function addArticle(item) {\n    setArticles([...articles, item]);\n    console.log(articles);\n  }\n\n  function price(item) {\n    console.log(queryStream.get('top_case'));\n    if (queryStream.get('top_case').toLowerCase() === 'oui') return item.price += 64.90;\n    return item.price;\n  }\n\n  function postCart() {\n    setLoading(true);\n    const body = {\n      'user_id': '622acb7b892b2eded00a736c',\n      'scooter': scooter,\n      'top_case_id': ''\n    };\n    axios.post(\"https://brum-ar-api.herokuapp.com/order/\", body).then(response => console.log(response.data)).catch(error => console.log(error)).finally(() => {\n      setArticles([]);\n      setLoading(false);\n      props.history.push('/success');\n    });\n  }\n\n  function getScooter(id) {\n    setLoading(true);\n    axios.get(\"https://brum-ar-api.herokuapp.com/scooter/\" + id).then(response => {\n      addArticle(response.data);\n      setScooter(response.data);\n    }).catch(error => console.log(error)).finally(() => setLoading(false));\n  }\n\n  function getTopcases(id) {\n    if (!id) return;\n    setLoading(true);\n    axios.get(\"https://brum-ar-api.herokuapp.com/top-case/\" + id).then(response => {\n      setTopCase(response.data);\n    }).catch(error => console.log(error)).finally(() => setLoading(false));\n  }\n\n  if (loading === true) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loader\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"cart__title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }\n  }, \"Commande : \"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart__articles\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }, Array.from(articles).map(it => /*#__PURE__*/React.createElement(\"div\", {\n    key: it._id,\n    className: \"article\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"article__img\",\n    src: getImg(it.color),\n    alt: '...',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"article__name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 33\n    }\n  }, it.name || ''), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"article__option\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 37\n    }\n  }, \"COULEUR : \", it.color || ''), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"article__option\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 37\n    }\n  }, 'SIÈGE : ' + it.saddle_color || ''), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"article__option\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 37\n    }\n  }, \"TOP CASE : \", queryStream.get('top_case') || 'Non')), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"article__price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 33\n    }\n  }, it.price || '', \"\\u20AC\")))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart__actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"cart__actions__cancel\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }, \"Retour\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"cart__actions__validate\",\n    onClick: () => postCart(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 21\n    }\n  }, \"Valider\"))));\n};\n\nexport default Cart;","map":{"version":3,"sources":["/Users/cryox/Documents/Github/ESGI/hackaton/brumar-api/src/components/cart/Cart.js"],"names":["React","useEffect","useState","axios","getImg","useNavigate","Cart","props","loading","setLoading","articles","setArticles","scooter","setScooter","topCase","setTopCase","queryStream","URLSearchParams","location","search","getScooter","get","console","log","addArticle","item","price","toLowerCase","postCart","body","post","then","response","data","catch","error","finally","history","push","id","getTopcases","Array","from","map","it","_id","color","name","saddle_color"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './Cart.css';\nimport axios from \"axios\";\nimport {getImg} from \"../common/FileUtils\";\nimport { useNavigate } from \"react-router-dom\";\n\n\nconst Cart = (props) => {\n    let [loading, setLoading] = useState(true);\n    let [articles, setArticles] = useState([]);\n    let [scooter, setScooter] = useState(null);\n    let [topCase, setTopCase] = useState(null);\n    const queryStream = new URLSearchParams(props.location.search)\n\n    useEffect(() => {\n        getScooter(queryStream.get('scooter_id'))\n        // getTopcases(queryStream.get('top_case'))\n    }, [])\n    useEffect(() => {\n        console.log(scooter)\n    }, [])\n\n    function addArticle(item) {\n        setArticles([...articles, item]);\n        console.log(articles)\n    }\n\n    function price(item) {\n        console.log(queryStream.get('top_case'))\n        if (queryStream.get('top_case').toLowerCase() === 'oui')\n            return item.price += 64.90\n        return item.price;\n    }\n\n    function postCart() {\n        setLoading(true)\n        const body = {\n            'user_id': '622acb7b892b2eded00a736c',\n            'scooter': scooter,\n            'top_case_id': ''\n        }\n        axios\n            .post(\"https://brum-ar-api.herokuapp.com/order/\", body)\n            .then(response => console.log(response.data))\n            .catch(error => console.log(error))\n            .finally(() => {\n                setArticles([])\n                setLoading(false)\n                props.history.push('/success')\n            })\n    }\n\n    function getScooter(id) {\n        setLoading(true)\n        axios\n            .get(\"https://brum-ar-api.herokuapp.com/scooter/\" + id)\n            .then(response => {\n                addArticle(response.data)\n                setScooter(response.data)\n            })\n            .catch(error => console.log(error))\n            .finally(() => setLoading(false))\n    }\n\n    function getTopcases(id) {\n        if (!id) return;\n        setLoading(true)\n        axios\n            .get(\"https://brum-ar-api.herokuapp.com/top-case/\" + id)\n            .then(response => {\n                setTopCase(response.data)\n            })\n            .catch(error => console.log(error))\n            .finally(() => setLoading(false))\n    }\n\n    if (loading === true) {\n        return <div className=\"loader\"/>\n    }\n    return (\n        <>\n            <h2 className='cart__title'>Commande : </h2>\n            <div className='cart'>\n                <div className='cart__articles'>\n                    {\n                        Array.from(articles).map(it => (\n                            <div key={it._id} className='article'>\n                                <img className='article__img' src={getImg(it.color)} alt={'...'}/>\n                                <p className='article__name'>{it.name || ''}</p>\n                                <div>\n                                    <p className='article__option'>COULEUR : {it.color || ''}</p>\n                                    <p className='article__option'>{'SIÈGE : ' + it.saddle_color || ''}</p>\n                                    <p className='article__option'>TOP CASE : {queryStream.get('top_case') || 'Non'}</p>\n                                </div>\n                                <p className='article__price'>{(it.price) || ''}€</p>\n                            </div>\n                        ))\n                    }\n                </div>\n                <div className='cart__actions'>\n                    <button className='cart__actions__cancel'>Retour</button>\n                    <button className='cart__actions__validate' onClick={() => postCart()}>Valider</button>\n                </div>\n            </div>\n        </>\n    );\n}\n\nexport default Cart;"]},"metadata":{},"sourceType":"module"}